homeRegion: &HOME_REGION us-east-1

centralSecurityServices:
  delegatedAdminAccount: Audit
  ebsDefaultVolumeEncryption:
    enable: true
    excludeRegions: []
  s3PublicAccessBlock:
    enable: true
    excludeAccounts: []
  scpRevertChangesConfig:
    enable: true
    snsTopicName: Security-Notifications
  macie:
    enable: true
    excludeRegions: []
    policyFindingsPublishingFrequency: SIX_HOURS
    publishSensitiveDataFindings: true
  guardDuty:
    enable: true
    excludeRegions: []
    s3Protection:
      enable: true
    eksProtection:
      enable: true
    exportConfiguration:
      enable: true
      overrideExisting: false
      destinationType: S3
      exportFrequency: FIFTEEN_MINUTES
  securityHub:
    enable: true
    regionAggregation: false
    excludeRegions: []
    standards:
      - name: AWS Foundational Security Standard
        enable: true
        controlsToDisable: []
      - name: PCI DSS
        enable: false
      - name: CIS AWS Foundations Benchmark
        enable: true
        controlsToDisable:
          - CIS.1.20
          - CIS.1.22
  detective:
    enable: false
    excludeRegions: []

awsConfig:
  enable: true
  ruleSets:
    - deploymentTargets:
        organizationalUnits:
          - Root
      rules:
        - name: acm-certificate-expiration-check
          identifier: ACM_CERTIFICATE_EXPIRATION_CHECK
          complianceResourceTypes:
            - AWS::ACM::Certificate
          inputParameters:
            daysToExpiration: '90'
        - name: cloudtrail-enabled
          identifier: CLOUD_TRAIL_ENABLED
        - name: ec2-volume-inuse-check
          identifier: EC2_VOLUME_INUSE_CHECK
          complianceResourceTypes:
            - AWS::EC2::Volume
        - name: iam-password-policy
          identifier: IAM_PASSWORD_POLICY
        - name: root-access-key-check
          identifier: ROOT_ACCESS_KEY_CHECK
        - name: s3-bucket-public-access-prohibited
          identifier: S3_BUCKET_PUBLIC_ACCESS_PROHIBITED
          complianceResourceTypes:
            - AWS::S3::Bucket

cloudWatch:
  metricSets:
    - regions:
        - *HOME_REGION
      deploymentTargets:
        organizationalUnits:
          - Root
      metrics:
        - filterName: UnauthorizedAPICalls
          logGroupName: aws-controltower/CloudTrailLogs
          filterPattern: '{ ($.errorCode = "*UnauthorizedOperation") || ($.errorCode = "AccessDenied*") }'
          metricTransformations:
            - metricName: UnauthorizedAPICalls
              metricNamespace: LogMetrics
              metricValue: '1'
        - filterName: ConsoleSigninWithoutMFA
          logGroupName: aws-controltower/CloudTrailLogs
          filterPattern: '{ ($.eventName = "ConsoleLogin") && ($.additionalEventData.MFAUsed != "Yes") }'
          metricTransformations:
            - metricName: ConsoleSigninWithoutMFA
              metricNamespace: LogMetrics
              metricValue: '1'

  alarmSets:
    - regions:
        - *HOME_REGION
      deploymentTargets:
        organizationalUnits:
          - Root
      alarms:
        - alarmName: UnauthorizedAPICalls
          alarmDescription: Alarm for unauthorized API calls
          snsTopicName: Security-Notifications
          metricName: UnauthorizedAPICalls
          namespace: LogMetrics
          comparisonOperator: GreaterThanOrEqualToThreshold
          evaluationPeriods: 1
          period: 300
          statistic: Sum
          threshold: 1
          treatMissingData: notBreaching

keyManagementService:
  keySets:
    - deploymentTargets:
        organizationalUnits:
          - Root
      keys:
        - name: ExampleKey
          description: Example KMS key for encryption
          enabled: true
          enableKeyRotation: true
          removalPolicy: retain
          alias: alias/example-key

accessAnalyzer:
  enable: true
  excludeRegions: []

iamPasswordPolicy:
  allowUsersToChangePassword: true
  hardExpiry: false
  requireUppercaseCharacters: true
  requireLowercaseCharacters: true
  requireSymbols: true
  requireNumbers: true
  minimumPasswordLength: 14
  passwordReusePrevention: 24
  maxPasswordAge: 90
